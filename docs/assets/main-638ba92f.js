(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();var s={};Object.defineProperty(s,"__esModule",{value:!0});s.permutations=s.polarToRectangular=s.makeBoundedLinear=b=s.makeLinear=s.sum=s.countMap=I=s.initializedArray=s.count=s.zip=s.FIGURE_SPACE=s.NON_BREAKING_SPACE=s.dateIsValid=s.MIN_DATE=s.MAX_DATE=s.makePromise=s.filterMap=A=s.pick=s.pickAny=s.csvStringToArray=s.parseTimeT=s.parseIntX=s.parseFloatX=s.getAttribute=s.followPath=s.parseXml=s.testXml=s.sleep=S=s.assertClass=void 0;function N(n,e,t="Assertion Failed."){const r=o=>{throw new Error(`${t}  Expected type:  ${e.name}.  Found type:  ${o}.`)};if(n===null)r("null");else if(typeof n!="object")r(typeof n);else if(!(n instanceof e))r(n.constructor.name);else return n;throw new Error("wtf")}var S=s.assertClass=N;function z(n){return new Promise(e=>setTimeout(e,n))}s.sleep=z;function P(n){const t=new DOMParser().parseFromString(n,"application/xml");for(const r of Array.from(t.querySelectorAll("parsererror")))if(r instanceof HTMLElement)return{error:r};return{parsed:t}}s.testXml=P;function X(n){if(n!==void 0)return P(n)?.parsed?.documentElement}s.parseXml=X;function B(n,...e){for(const t of e){if(n===void 0)return;if(typeof t=="number")n=n.children[t];else{const r=n.getElementsByTagName(t);if(r.length!=1)return;n=r[0]}}return n}s.followPath=B;function _(n,e,...t){if(e=B(e,...t),e!==void 0&&e.hasAttribute(n))return e.getAttribute(n)??void 0}s.getAttribute=_;function L(n){if(n==null)return;const e=parseFloat(n);if(isFinite(e))return e}s.parseFloatX=L;function G(n){const e=L(n);if(e!==void 0)return e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||e!=Math.floor(e)?void 0:e}s.parseIntX=G;function D(n){if(typeof n=="string"&&(n=G(n)),n!=null&&!(n<=0))return new Date(n*1e3)}s.parseTimeT=D;const O=n=>{const e=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,t=[[]];let r;for(;r=e.exec(n);)r[1].length&&r[1]!==","&&t.push([]),t[t.length-1].push(r[2]!==void 0?r[2].replace(/""/g,'"'):r[3]);return t};s.csvStringToArray=O;function x(n){const e=n.values().next();if(!e.done)return e.value}s.pickAny=x;function U(n){return n[Math.random()*n.length|0]}var A=s.pick=U;function H(n,e){const t=[];return n.forEach((r,o)=>{const i=e(r,o);i!==void 0&&t.push(i)}),t}s.filterMap=H;function $(){let n,e;return{promise:new Promise((r,o)=>{n=r,e=o}),resolve:n,reject:e}}s.makePromise=$;s.MAX_DATE=new Date(864e13);s.MIN_DATE=new Date(-864e13);function V(n){return isFinite(n.getTime())}s.dateIsValid=V;s.NON_BREAKING_SPACE=" ";s.FIGURE_SPACE=" ";function*Z(...n){const e=n.map(t=>t[Symbol.iterator]());for(;;){const t=e.map(r=>r.next());if(t.some(({done:r})=>r))break;yield t.map(({value:r})=>r)}}s.zip=Z;function*j(n=0,e=1/0,t=1){for(let r=n;r<e;r+=t)yield r}s.count=j;function k(n,e){const t=[];for(let r=0;r<n;r++)t.push(e(r));return t}var I=s.initializedArray=k;s.countMap=k;function q(n){return n.reduce((e,t)=>e+t,0)}s.sum=q;function K(n,e,t,r){const o=(r-e)/(t-n);return function(i){return(i-n)*o+e}}var b=s.makeLinear=K;function Q(n,e,t,r){t<n&&([n,e,t,r]=[t,r,n,e]);const o=(r-e)/(t-n);return function(i){return i<=n?e:i>=t?r:(i-n)*o+e}}s.makeBoundedLinear=Q;function Y(n,e){return{x:Math.sin(e)*n,y:Math.cos(e)*n}}s.polarToRectangular=Y;function*R(n,e=[]){if(n.length==0)yield e;else for(let t=0;t<n.length;t++){const r=n[t],o=[...e,r],i=[...n.slice(0,t),...n.slice(t+1)];yield*R(i,o)}}s.permutations=R;var u={};Object.defineProperty(u,"__esModule",{value:!0});u.download=u.createElementFromHTML=u.getHashInfo=u.getAudioBalanceControl=u.getBlobFromCanvas=u.loadDateTimeLocal=g=u.getById=void 0;const F=s;function J(n,e){const t=document.getElementById(n);if(!t)throw new Error("Could not find element with id "+n+".  Expected type:  "+e.name);if(t instanceof e)return t;throw new Error("Element with id "+n+" has type "+t.constructor.name+".  Expected type:  "+e.name)}var g=u.getById=J;function W(n,e,t="milliseconds"){let r;switch(t){case"minutes":{r=e.getSeconds()*1e3+e.getMilliseconds();break}case"seconds":{r=e.getMilliseconds();break}case"milliseconds":{r=0;break}default:throw new Error("wtf")}n.valueAsNumber=+e-e.getTimezoneOffset()*6e4-r}u.loadDateTimeLocal=W;function ee(n){const{reject:e,resolve:t,promise:r}=(0,F.makePromise)();return n.toBlob(o=>{o?t(o):e(new Error("blob is null!"))}),r}u.getBlobFromCanvas=ee;function te(n){const e=new AudioContext,t=e.createMediaElementSource(n),r=new StereoPannerNode(e,{pan:0});return t.connect(r).connect(e.destination),o=>{r.pan.value=o}}u.getAudioBalanceControl=te;function ne(){const n=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(r=>{const o=r.split("=",2);if(o.length==2){const i=decodeURIComponent(o[0]),c=decodeURIComponent(o[1]);n.set(i,c)}}),n}u.getHashInfo=ne;function re(n,e){var t=document.createElement("div");return t.innerHTML=n.trim(),(0,F.assertClass)(t.firstChild,e,"createElementFromHTML:")}u.createElementFromHTML=re;function oe(n,e){var t=document.createElement("a");if(t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",n),document.createEvent){var r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),t.dispatchEvent(r)}else t.click()}u.download=oe;{let n="☆";setInterval(()=>{document.title=`${n} Classic Chuzzle`,n=n=="☆"?"★":"☆"},1e3)}function y(n,e){const t=n%e;return t<0?t+Math.abs(e):t}const T=["red","green","blue","yellow","orange","violet"];class w{constructor(e){this.piece=e;const t=S(w.#t.cloneNode(!0),SVGGElement);this.element=t,t.setAttribute("fill",e.color),w.#e.appendChild(t)}static#e=g("board",SVGElement);static#t=g("piece",HTMLTemplateElement).content.querySelector("g");element;setPosition(e,t){this.element.setAttribute("transform",`translate(${t}, ${e})`)}remove(){this.element.remove()}}function ie(n,e){if((e|0)!=e)throw new Error(`invalid input: ${e}`);return e=y(e,n.length),e==0?n:[...n.slice(e),...n.slice(0,e)]}class E{constructor(e,t,r){this.row=e,this.column=t,this.piece=r,this.#e=new M(this)}#e;get color(){return this.piece.color}static createAll(e){return e.map((t,r)=>t.map((o,i)=>new E(r,i,o)))}tryCombine(e){if(this.#e!=e.#e&&this.color==e.color&&(this.#e.consume(e.#e).forEach(r=>r.#e=this.#e),!this.#e.valid))throw window.showGreen(),new Error("wtf")}static combineAll(e){window.showGreen=()=>{const t=[],r=[];e.forEach(o=>{o.forEach(i=>{i.color=="green"&&(t.push(i.#e.debugInfo()),r.push(i.#e))})}),console.table(t),console.log(r)},e.forEach((t,r)=>{t.forEach((o,i)=>{if(r){const c=r-1,a=e[c][i];o.tryCombine(a)}if(i){const c=i-1,a=t[c];o.tryCombine(a)}})}),delete window.showGreen}static findBigGroups(e){const t=new Map;e.forEach(o=>o.forEach(i=>{const c=i.#e,a=t.get(c)??0;t.set(c,a+1)}));const r=[];for(const[o,i]of t)i>=3&&r.push(o);return r}static findActionable(e){const t=this.createAll(e);return this.combineAll(t),this.findBigGroups(t)}}class M{#e=new Set;get contents(){return this.#e}static#t=0;#n=M.#t++;debugInitialGroup;debugInfo(){return{row:this.debugInitialGroup.row,column:this.debugInitialGroup.column,contents:this.valid?this.#e.size:"invalid",id:this.#n}}constructor(e){this.debugInitialGroup=e,this.#e.add(e)}consume(e){const t=this.#e,r=e.#e;return r.forEach(o=>t.add(o)),e.#e=void 0,r}get valid(){return!!this.#e?.has(this.debugInitialGroup)}}class f{constructor(e){this.allPieces=e}static SIZE=6;static createRandom(){const e=I(f.SIZE,()=>I(f.SIZE,()=>({weight:1,color:A(T)})));return E.findActionable(e).forEach(r=>{r.contents.forEach(({row:o,column:i})=>{const c=new Set;[[0,1],[0,-1],[1,0],[-1,0]].forEach(([a,l])=>{const p=e[o+a];if(p){const d=p[i+l];d&&c.add(d.color)}}),e[o][i]={color:A(T.filter(a=>!c.has(a))),weight:1}})}),new this(e)}static QUICK=this.createRandom();rotateLeft(e,t){const r=this.allPieces[e],o=ie(r,t);return r==o?this:new f(this.allPieces.map(i=>i==r?o:i))}rotateUp(e,t){const r=this.allPieces.length;return t=y(t,r),t==0?this:new f(this.allPieces.map((o,i)=>{const c=[...o];return c[e]=this.allPieces[(i+t)%r][e],c}))}}class h{constructor(){throw h.#n,new Error("wtf")}static#e=[];static#t=f.createRandom();static get currentBoard(){return this.#t}static set currentBoard(e){this.#t=e,this.draw(e),this.hideTemporaries()}static hideTemporaries(){}static draw(e){this.resetAll(),this.#e=e.allPieces.map((t,r)=>t.map((o,i)=>{const c=new w(o);return c.setPosition(r,i),c}))}static resetAll(){this.#e.forEach(e=>{e.forEach(t=>{t.remove()})}),this.#e=[],this.hideTemporaries()}static#n=(()=>{this.draw(this.#t);const e=g("board",SVGElement);function t(a){const l=e.getBoundingClientRect(),p=b(l.top,0,l.bottom,f.SIZE),d=b(l.left,0,l.right,f.SIZE);return{row:p(a.clientY),column:d(a.clientX)}}let r="none",o=-1,i=-1,c=-1;e.addEventListener("pointerdown",a=>{if(r=="none"){r="started",e.setPointerCapture(a.pointerId);const l=t(a);o=l.row,i=l.column,e.style.cursor="move"}}),e.addEventListener("pointermove",a=>{if(r=="none")return;const l=t(a);if(r=="started"){const d=Math.abs(l.row-o),m=Math.abs(l.column-i);if(Math.max(d,m)<.05)return;if(d>m)r="vertical",e.style.cursor="ns-resize",c=Math.floor(i);else if(m>d)r="horizontal",e.style.cursor="ew-resize",c=Math.floor(o);else return;c=Math.max(0,Math.min(f.SIZE,c))}const p=d=>y(d+.5,f.SIZE)-.5;if(r=="horizontal"){const d=i-l.column;this.#e[c].forEach((v,C)=>{v.setPosition(c,p(C-d))})}else if(r=="vertical"){const d=o-l.row;this.#e.forEach((m,v)=>{m[c].setPosition(p(v-d),c)})}}),e.addEventListener("pointerup",a=>{if(r=="none")return;const l=t(a);r=="horizontal"?this.currentBoard=this.currentBoard.rotateLeft(c,Math.round(i-l.column)):r=="vertical"?this.currentBoard=this.currentBoard.rotateUp(c,Math.round(o-l.row)):r=="started"&&this.draw(this.currentBoard),r="none",e.style.cursor="",console.log("pointerup",t(a))})})()}function se(){const n=E.findActionable(h.currentBoard.allPieces);console.log(n)}window.checkGroups=se;window.rotateLeft=(n,e)=>{h.currentBoard=h.currentBoard.rotateLeft(n,e)};window.rotateUp=(n,e)=>{h.currentBoard=h.currentBoard.rotateUp(n,e)};{const n=["pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture"],e=document.createElement("div");document.body.appendChild(e);const t=document.createElement("div");t.style.color="gray",document.body.appendChild(t);const r=document.querySelector("svg");n.forEach(o=>{const i=document.createElement("div");i.innerText=o,t.appendChild(i),r.addEventListener(o,c=>{i.parentElement==t&&console.log(o,c,i),e.insertBefore(i,e.firstElementChild)})})}
