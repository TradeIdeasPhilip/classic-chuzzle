(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();var s={};Object.defineProperty(s,"__esModule",{value:!0});s.permutations=s.polarToRectangular=s.makeBoundedLinear=k=s.makeLinear=s.sum=s.countMap=b=s.initializedArray=s.count=s.zip=s.FIGURE_SPACE=s.NON_BREAKING_SPACE=s.dateIsValid=s.MIN_DATE=s.MAX_DATE=s.makePromise=s.filterMap=g=s.pick=s.pickAny=s.csvStringToArray=s.parseTimeT=s.parseIntX=s.parseFloatX=s.getAttribute=s.followPath=s.parseXml=s.testXml=s.sleep=T=s.assertClass=void 0;function N(r,e,t="Assertion Failed."){const n=o=>{throw new Error(`${t}  Expected type:  ${e.name}.  Found type:  ${o}.`)};if(r===null)n("null");else if(typeof r!="object")n(typeof r);else if(!(r instanceof e))n(r.constructor.name);else return r;throw new Error("wtf")}var T=s.assertClass=N;function _(r){return new Promise(e=>setTimeout(e,r))}s.sleep=_;function P(r){const t=new DOMParser().parseFromString(r,"application/xml");for(const n of Array.from(t.querySelectorAll("parsererror")))if(n instanceof HTMLElement)return{error:n};return{parsed:t}}s.testXml=P;function x(r){if(r!==void 0)return P(r)?.parsed?.documentElement}s.parseXml=x;function S(r,...e){for(const t of e){if(r===void 0)return;if(typeof t=="number")r=r.children[t];else{const n=r.getElementsByTagName(t);if(n.length!=1)return;r=n[0]}}return r}s.followPath=S;function z(r,e,...t){if(e=S(e,...t),e!==void 0&&e.hasAttribute(r))return e.getAttribute(r)??void 0}s.getAttribute=z;function B(r){if(r==null)return;const e=parseFloat(r);if(isFinite(e))return e}s.parseFloatX=B;function L(r){const e=B(r);if(e!==void 0)return e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||e!=Math.floor(e)?void 0:e}s.parseIntX=L;function X(r){if(typeof r=="string"&&(r=L(r)),r!=null&&!(r<=0))return new Date(r*1e3)}s.parseTimeT=X;const D=r=>{const e=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi,t=[[]];let n;for(;n=e.exec(r);)n[1].length&&n[1]!==","&&t.push([]),t[t.length-1].push(n[2]!==void 0?n[2].replace(/""/g,'"'):n[3]);return t};s.csvStringToArray=D;function O(r){const e=r.values().next();if(!e.done)return e.value}s.pickAny=O;function U(r){return r[Math.random()*r.length|0]}var g=s.pick=U;function H(r,e){const t=[];return r.forEach((n,o)=>{const i=e(n,o);i!==void 0&&t.push(i)}),t}s.filterMap=H;function $(){let r,e;return{promise:new Promise((n,o)=>{r=n,e=o}),resolve:r,reject:e}}s.makePromise=$;s.MAX_DATE=new Date(864e13);s.MIN_DATE=new Date(-864e13);function V(r){return isFinite(r.getTime())}s.dateIsValid=V;s.NON_BREAKING_SPACE=" ";s.FIGURE_SPACE=" ";function*Z(...r){const e=r.map(t=>t[Symbol.iterator]());for(;;){const t=e.map(n=>n.next());if(t.some(({done:n})=>n))break;yield t.map(({value:n})=>n)}}s.zip=Z;function*j(r=0,e=1/0,t=1){for(let n=r;n<e;n+=t)yield n}s.count=j;function G(r,e){const t=[];for(let n=0;n<r;n++)t.push(e(n));return t}var b=s.initializedArray=G;s.countMap=G;function q(r){return r.reduce((e,t)=>e+t,0)}s.sum=q;function K(r,e,t,n){const o=(n-e)/(t-r);return function(i){return(i-r)*o+e}}var k=s.makeLinear=K;function Q(r,e,t,n){t<r&&([r,e,t,n]=[t,n,r,e]);const o=(n-e)/(t-r);return function(i){return i<=r?e:i>=t?n:(i-r)*o+e}}s.makeBoundedLinear=Q;function Y(r,e){return{x:Math.sin(e)*r,y:Math.cos(e)*r}}s.polarToRectangular=Y;function*R(r,e=[]){if(r.length==0)yield e;else for(let t=0;t<r.length;t++){const n=r[t],o=[...e,n],i=[...r.slice(0,t),...r.slice(t+1)];yield*R(i,o)}}s.permutations=R;var u={};Object.defineProperty(u,"__esModule",{value:!0});u.download=u.createElementFromHTML=u.getHashInfo=u.getAudioBalanceControl=u.getBlobFromCanvas=u.loadDateTimeLocal=E=u.getById=void 0;const F=s;function J(r,e){const t=document.getElementById(r);if(!t)throw new Error("Could not find element with id "+r+".  Expected type:  "+e.name);if(t instanceof e)return t;throw new Error("Element with id "+r+" has type "+t.constructor.name+".  Expected type:  "+e.name)}var E=u.getById=J;function W(r,e,t="milliseconds"){let n;switch(t){case"minutes":{n=e.getSeconds()*1e3+e.getMilliseconds();break}case"seconds":{n=e.getMilliseconds();break}case"milliseconds":{n=0;break}default:throw new Error("wtf")}r.valueAsNumber=+e-e.getTimezoneOffset()*6e4-n}u.loadDateTimeLocal=W;function ee(r){const{reject:e,resolve:t,promise:n}=(0,F.makePromise)();return r.toBlob(o=>{o?t(o):e(new Error("blob is null!"))}),n}u.getBlobFromCanvas=ee;function te(r){const e=new AudioContext,t=e.createMediaElementSource(r),n=new StereoPannerNode(e,{pan:0});return t.connect(n).connect(e.destination),o=>{n.pan.value=o}}u.getAudioBalanceControl=te;function re(){const r=new Map;return/^#?(.*)$/.exec(location.hash.replace("+","%20"))[1].split("&").forEach(n=>{const o=n.split("=",2);if(o.length==2){const i=decodeURIComponent(o[0]),a=decodeURIComponent(o[1]);r.set(i,a)}}),r}u.getHashInfo=re;function ne(r,e){var t=document.createElement("div");return t.innerHTML=r.trim(),(0,F.assertClass)(t.firstChild,e,"createElementFromHTML:")}u.createElementFromHTML=ne;function oe(r,e){var t=document.createElement("a");if(t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",r),document.createEvent){var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0),t.dispatchEvent(n)}else t.click()}u.download=oe;{let r="☆";setInterval(()=>{document.title=`${r} Classic Chuzzle`,r=r=="☆"?"★":"☆"},1e3)}function A(r,e){const t=r%e;return t<0?t+Math.abs(e):t}const C=["red","green","blue","yellow","orange","violet"];class v{constructor(e){this.piece=e;const t=T(v.#t.cloneNode(!0),SVGGElement);this.element=t,t.setAttribute("fill",e.color),v.#e.appendChild(t)}static#e=E("board",SVGElement);static#t=E("piece",HTMLTemplateElement).content.querySelector("g");element;setPosition(e,t){this.element.setAttribute("transform",`translate(${t}, ${e})`)}remove(){this.element.remove()}}function ie(r,e){if((e|0)!=e)throw new Error(`invalid input: ${e}`);return e=A(e,r.length),e==0?r:[...r.slice(e),...r.slice(0,e)]}class w{constructor(e,t,n){this.row=e,this.column=t,this.piece=n,this.#e=new I(this)}#e;get color(){return this.piece.color}static createAll(e){return e.map((t,n)=>t.map((o,i)=>new w(n,i,o)))}tryCombine(e){if(this.#e!=e.#e&&this.color==e.color&&(this.#e.consume(e.#e).forEach(n=>n.#e=this.#e),!this.#e.valid))throw window.showGreen(),new Error("wtf")}static combineAll(e){window.showGreen=()=>{const t=[],n=[];e.forEach(o=>{o.forEach(i=>{i.color=="green"&&(t.push(i.#e.debugInfo()),n.push(i.#e))})}),console.table(t),console.log(n)},e.forEach((t,n)=>{t.forEach((o,i)=>{if(n){const a=n-1,c=e[a][i];o.tryCombine(c)}if(i){const a=i-1,c=t[a];o.tryCombine(c)}})}),delete window.showGreen}static findBigGroups(e){const t=new Map;e.forEach(o=>o.forEach(i=>{const a=i.#e,c=t.get(a)??0;t.set(a,c+1)}));const n=[];for(const[o,i]of t)i>=3&&n.push(o);return n}static findActionable(e){const t=this.createAll(e);return this.combineAll(t),this.findBigGroups(t)}}class I{#e=new Set;get contents(){return this.#e}static#t=0;#r=I.#t++;debugInitialGroup;debugInfo(){return{row:this.debugInitialGroup.row,column:this.debugInitialGroup.column,contents:this.valid?this.#e.size:"invalid",id:this.#r}}color;constructor(e){this.color=e.color,this.debugInitialGroup=e,this.#e.add(e)}consume(e){const t=this.#e,n=e.#e;return n.forEach(o=>t.add(o)),e.#e=void 0,n}get valid(){return!!this.#e?.has(this.debugInitialGroup)}}class h{constructor(e){this.allPieces=e}static SIZE=6;static createRandom(){const e=b(h.SIZE,()=>b(h.SIZE,()=>({weight:1,color:g(C)})));return w.findActionable(e).forEach(n=>{n.contents.forEach(({row:o,column:i})=>{const a=new Set;[[0,1],[0,-1],[1,0],[-1,0]].forEach(([c,l])=>{const f=e[o+c];if(f){const d=f[i+l];d&&a.add(d.color)}}),e[o][i]={color:g(C.filter(c=>!a.has(c))),weight:1}})}),new this(e)}static QUICK=this.createRandom();rotateLeft(e,t){const n=this.allPieces[e],o=ie(n,t);return n==o?this:new h(this.allPieces.map(i=>i==n?o:i))}rotateUp(e,t){const n=this.allPieces.length;return t=A(t,n),t==0?this:new h(this.allPieces.map((o,i)=>{const a=[...o];return a[e]=this.allPieces[(i+t)%n][e],a}))}}class p{constructor(){throw p.#o,new Error("wtf")}static#e=[];static#t=h.createRandom();static get currentBoard(){return this.#t}static set currentBoard(e){this.#t=e,this.draw(),this.hideTemporaries()}static hideTemporaries(){}static#r=new Map([["orange",["cyan","brown","white","darkviolet","lightyellow","darkgreen","darkolivegreen","darkred"]],["yellow",["brown","darkviolet","lightcoral","lightsalmon","lightseagreen","darkblue","darkcyan","darkgoldenrod","darkgreen","darkkhaki","darkolivegreen","darkorange","darkred","darksalmon","darkseagreen"]],["violet",["cyan","brown","white","darkviolet","lightgreen","darkblue"]],["blue",["cyan","white","lightcoral","lightgreen","lightgray","lightsalmon","lightseagreen","lightseagreen","lightskyblue","lightslategray","darkorange","darkseagreen","darkturquoise"]],["red",["cyan","white","lightcoral","lightgreen","lightsalmon","darkkhaki","darkseagreen","chartreuse"]],["green",["cyan","white","lightcoral","lightcyan","lightgreen","lightyellow","darkred","darkseagreen","chartreuse"]]]);static#n=["ʻ","☆","𝛿","∞","•","★","†","‡","¿","*","◦","§","_"];static showGroups(){w.findActionable(this.#t.allPieces).forEach(t=>{const n=g(this.#r.get(t.color)),o=g(this.#n);t.contents.forEach(i=>{const{row:a,column:c}=i,f=this.#e[a][c].element.querySelector("text");f.textContent=o,f.style.fill=n})})}static draw(){this.resetAll(),this.#e=this.#t.allPieces.map((e,t)=>e.map((n,o)=>{const i=new v(n);return i.setPosition(t,o),i})),this.showGroups()}static resetAll(){this.#e.forEach(e=>{e.forEach(t=>{t.remove()})}),this.#e=[],this.hideTemporaries()}static#o=(()=>{this.draw();const e=E("board",SVGElement);function t(c){const l=e.getBoundingClientRect(),f=k(l.top,0,l.bottom,h.SIZE),d=k(l.left,0,l.right,h.SIZE);return{row:f(c.clientY),column:d(c.clientX)}}let n="none",o=-1,i=-1,a=-1;e.addEventListener("pointerdown",c=>{if(n=="none"){c.stopPropagation(),n="started",e.setPointerCapture(c.pointerId);const l=t(c);o=l.row,i=l.column,e.style.cursor="move"}}),e.addEventListener("pointermove",c=>{if(n=="none")return;c.stopPropagation();const l=t(c);if(n=="started"){const d=Math.abs(l.row-o),m=Math.abs(l.column-i);if(Math.max(d,m)<.05)return;if(d>m)n="vertical",e.style.cursor="ns-resize",a=Math.floor(i);else if(m>d)n="horizontal",e.style.cursor="ew-resize",a=Math.floor(o);else return;a=Math.max(0,Math.min(h.SIZE,a))}const f=d=>A(d+.5,h.SIZE)-.5;if(n=="horizontal"){const d=i-l.column;this.#e[a].forEach((y,M)=>{y.setPosition(a,f(M-d))})}else if(n=="vertical"){const d=o-l.row;this.#e.forEach((m,y)=>{m[a].setPosition(f(y-d),a)})}}),e.addEventListener("lostpointercapture",c=>{if(n=="none")return;const l=t(c);n=="horizontal"?this.currentBoard=this.currentBoard.rotateLeft(a,Math.round(i-l.column)):n=="vertical"?this.currentBoard=this.currentBoard.rotateUp(a,Math.round(o-l.row)):n=="started"&&this.draw(),n="none",e.style.cursor=""})})()}function se(){const r=w.findActionable(p.currentBoard.allPieces);console.log(r)}window.checkGroups=se;window.rotateLeft=(r,e)=>{p.currentBoard=p.currentBoard.rotateLeft(r,e)};window.rotateUp=(r,e)=>{p.currentBoard=p.currentBoard.rotateUp(r,e)};{const r=["pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture"],e=document.createElement("div");document.body.appendChild(e);const t=document.querySelector("svg");r.forEach(n=>{let o=document.createElement("div");o.innerText=n,o.style.color="lightgrey",e.appendChild(o),t.addEventListener(n,i=>{o.remove(),o=document.createElement("div"),o.innerText=n,o.classList.add("event-fired"),e.insertBefore(o,e.firstElementChild)})})}
